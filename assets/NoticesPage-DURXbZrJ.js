import{j as e,I as P,r as c,m as K,u as G,f as q,n as O,o as V,e as B,p as H,q as J,t as W,v as X}from"./index-StbH1q_x.js";import{a as Y,F as Z,P as _}from"./Pagination-DsLcCMTD.js";import{u as Q,C as ee}from"./index.esm-D1OiaW1o.js";import{c as se,a as M,o as te}from"./index.esm-Bi2V2m2e.js";const ne=({title:s,imgURL:i,popularity:t,name:r,birthday:o,sex:a,species:u,category:l,comment:h})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"notices-card",children:[e.jsxs("div",{className:"notices-card-top",children:[e.jsx("img",{src:i,alt:s,className:"notices-img"}),e.jsxs("div",{className:"notices-title-wrap",children:[e.jsx("h3",{className:"notices-title",children:s}),e.jsxs("div",{className:"notices-icon-wrap",children:[e.jsx(P,{className:"icon-star",name:"star"}),e.jsx("p",{className:"notices-popularity",children:t})]})]}),e.jsxs("div",{className:"notices-text-wrapper",children:[e.jsxs("div",{className:"notices-text-wrap",children:[e.jsx("p",{className:"notices-title-text",children:"Name"}),e.jsx("p",{children:r})]}),e.jsxs("div",{className:"notices-text-wrap",children:[e.jsx("p",{className:"notices-title-text",children:"Birthday"}),e.jsx("p",{children:Y(o)})]}),e.jsxs("div",{className:"notices-text-wrap",children:[e.jsx("p",{className:"notices-title-text",children:"Sex"}),e.jsx("p",{children:a})]}),e.jsxs("div",{className:"notices-text-wrap",children:[e.jsx("p",{className:"notices-title-text",children:"Species"}),e.jsx("p",{children:u})]}),e.jsxs("div",{className:"notices-text-wrap",children:[e.jsx("p",{className:"notices-title-text",children:"Category"}),e.jsx("p",{children:l})]})]}),e.jsx("p",{className:"notices-text",children:h})]}),e.jsxs("div",{className:"notices-button-wrap",children:[e.jsx("button",{type:"button",className:"notices-button",children:"Read more"}),e.jsx("div",{className:"notices-add-favorite",children:e.jsx(P,{className:"icon-heart",name:"heart"})})]})]})}),ae=(s,i,t)=>{c.useEffect(()=>{const r=a=>{a.code==="Escape"&&s(!1)},o=a=>{i.current&&!i.current.contains(a.target)&&(t!=null&&t.current)&&!(t!=null&&t.current.contains(a.target))&&s(!1)};return window.addEventListener("keydown",r),document.addEventListener("mousedown",o),()=>{window.removeEventListener("keydown",r),document.removeEventListener("mousedown",o)}},[s,i,t])},L=K.forwardRef(({onSelect:s,onClose:i,data:t},r)=>{const o=l=>{s(l)},a=()=>{s("")},u=c.useRef(null);return ae(i,u,r),e.jsx("div",{className:"menu-modal",children:e.jsx("div",{className:"menu-modal-container",children:e.jsxs("ul",{className:"menu-categories-list",ref:u,children:[e.jsx("li",{className:"menu-categories-item",onClick:a,children:"Show all"}),t&&t.map(l=>e.jsx("li",{className:"menu-categories-item",onClick:()=>o(l),children:l},l))]})})})}),ce=["sell","free","lost","found"],ie=["unknown","female","male","multiple"],oe=["dog","cat","monkey","bird","snake","turtle","lizard","frog","fish","ants","bees","butterfly","spider","scorpion"],D=({placeholder:s,setSearchQuery:i})=>{const t=se({category:M(),sex:M(),species:M()}).required(),{handleSubmit:r,control:o,setValue:a}=Q({resolver:te(t)}),u=G(),l=c.useRef(null),h=c.useRef(null),n=c.useRef(null),v=c.useRef(null),[m,k]=q(),[x,g]=c.useState(m.get("category")??""),[j,y]=c.useState(m.get("sex")??""),[f,C]=c.useState(m.get("species")??""),[w,N]=c.useState(!1),[S,E]=c.useState(!1),[T,F]=c.useState(!1),A=d=>{i(p=>({...p,...d})),I(d),u(O(1))},z=()=>{s==="Category"?N(!w):s==="By gender"?E(!S):F(!T)},R=d=>{const p={};s==="Category"?(g(d),p.category=d||void 0):s==="By gender"?(y(d),p.sex=d||void 0):(C(d),p.species=d||void 0),N(!1),E(!1),F(!1),I(p),r(A)()},I=d=>{const p=new URLSearchParams(m);Object.entries(d).forEach(([U,$])=>{$?p.set(U,$):p.delete(U)}),k(p)};return c.useEffect(()=>{g(m.get("category")??""),y(m.get("sex")??""),C(m.get("type")??"")},[m]),c.useEffect(()=>{a("category",x||""),a("sex",j||""),a("species",f||"")},[x,j,f,a]),e.jsx("form",{onSubmit:r(A),ref:l,children:e.jsxs("div",{className:`find-form-wrap ${s==="Category"||s==="By gender"?"category":s==="By type"?"type":""}`,children:[e.jsx(ee,{name:s==="Category"?"category":s==="By gender"?"sex":"species",control:o,render:({field:d})=>e.jsx("input",{...d,className:"input find-input",placeholder:s,value:s==="Category"?x:s==="By gender"?j:f})}),e.jsx("button",{type:"button",className:"find-form-button",onClick:z,ref:s==="Category"?h:s==="By gender"?n:v,children:e.jsx("div",{className:"find-form-icon",children:e.jsx(P,{name:"chevron-down",className:"icon-search"})})}),w&&e.jsx(L,{onSelect:R,onClose:()=>N(!1),ref:h,data:ce}),S&&e.jsx(L,{onSelect:R,onClose:()=>E(!1),ref:n,data:ie}),T&&e.jsx(L,{onSelect:R,onClose:()=>F(!1),ref:v,data:oe})]})})},b=({setSearchQuery:s,text:i,isActive:t,onClick:r})=>{const o=()=>{s(a=>({...a,title:t?"":i})),r()};return e.jsx("div",{className:"button-wrap",children:e.jsxs("button",{type:"submit",className:`sort-button ${t?"cross":""}`,onClick:o,children:[i,t&&e.jsx(P,{className:"icon-cross",name:"close"})]})})},re=({setSearchQuery:s})=>{const i=G(),[t,r]=c.useState(null),o=a=>{r(t===a?null:a),i(V(a))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"notices-form-wrap",children:[e.jsxs("div",{className:"notices-form-top",children:[e.jsx(Z,{setSearchQuery:s,placeholder:"Search"}),e.jsx(D,{setSearchQuery:s,placeholder:"Category"}),e.jsx(D,{setSearchQuery:s,placeholder:"By gender"}),e.jsx(D,{setSearchQuery:s,placeholder:"By type"})]}),e.jsx("div",{className:"notices-stroke"}),e.jsxs("div",{className:"sort-button-wrap",children:[e.jsx(b,{setSearchQuery:s,text:"Popular",isActive:t==="Popular",onClick:()=>o("Popular")}),e.jsx(b,{setSearchQuery:s,text:"Unpopular",isActive:t==="Unpopular",onClick:()=>o("Unpopular")}),e.jsx(b,{setSearchQuery:s,text:"Cheap",isActive:t==="Cheap",onClick:()=>o("Cheap")}),e.jsx(b,{setSearchQuery:s,text:"Expensive",isActive:t==="Expensive",onClick:()=>o("Expensive")})]})]})})},ue=()=>{const s=B(H),i=B(J),[t,r]=c.useState([]);c.useEffect(()=>{if(s.length>0&&i==="Popular"){const x=[...s].sort((g,j)=>j.popularity-g.popularity);r(x)}},[s,i]);const o=6,[a,u]=q();c.useEffect(()=>{a.has("page")||u({page:"1"})},[a,u]);const l=Number(a.get("page"))||1,h=B(W),[n,v]=c.useState({title:a.get("title")||null,category:a.get("category")||null,sex:a.get("sex")||null,species:a.get("species")||null}),m=G();c.useEffect(()=>{const x={page:l,limit:o,title:n!=null&&n.title?n.title:null,category:n!=null&&n.category?n.category:null,sex:n!=null&&n.sex?n.sex:null,species:n!=null&&n.species?n.species:null};m(X(x))},[l,m,n]);const k=x=>{u({page:String(x),...n.title&&{title:String(n.title)},...n.category&&{category:String(n.category)},...n.sex&&{sex:String(n.sex)},...n.species&&{species:String(n.species)}})};return e.jsxs("div",{className:"notices-container",children:[e.jsxs("div",{className:"notices-main-wrap",children:[e.jsx("h2",{className:"notices-main-title",children:"Find your favorite pet"}),e.jsx(re,{setSearchQuery:v})]}),e.jsx("div",{className:"news-cards notices-cards",children:t&&t.length>0?t.map(({name:x,title:g,imgURL:j,species:y,birthday:f,sex:C,category:w,comment:N,popularity:S})=>e.jsx(ne,{name:x,title:g,imgURL:j,species:y,birthday:f,sex:C,category:w,comment:N,popularity:S},g)):e.jsx("p",{children:"There are news yet"})}),e.jsx(_,{totalItems:h,currentPage:l,onPageChange:k})]})};export{ue as default};
